<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Dashboard/vizualization/dashboard.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Dashboard/vizualization/dashboard.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component } from "react";
import "./dashboard.css";
import { getAssetSelected, getAssetsStats } from "./dashboardAction";
import { createSelector } from "reselect";
import { connect } from "react-redux";
import {
  BarChart, Bar, Label, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer
} from 'recharts';
import { Tabs, Tab, Card } from "react-bootstrap";
import Alert from "react-bootstrap/Alert";
import { updateAlert } from "../../CommonComponents/Alert/alertAction";


/**
 * Component for dashboard page.
 * 
 * @component
 */
class Dashboard extends Component {

  /** 
    * @constructor
    */
  constructor(props) {
    super(props);
    this.state = {
      assetsStats: [],
      assetSelected: {
        label: "",
        problemsRelated: "",
        mostFoundItems: [],
        mostFoundSolutions: [],
        mostFoundProblems: []
      },
      colors: ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#d92727'],
      isMachineNameSelected: false
    }
  }

  /**
   * A react lifecycle method called when the component did mount.
   * It loads the stats of the assets
   */
  componentDidMount() {
    if (this.props.dashboard.assetsStats.length === 0 &amp;&amp; this.props.singleTokens.length >= 1) {
      // TODO : pas faire ce call si jamais ya pas de singleTokens 
      this.props.onGetAssetsStats(this.props.dashboard.assetSelected);
    }
    if (this.props.dashboard.assetsStats) {
      const newAssetsStats = this.props.dashboard.assetsStats;
      this.setState({ assetsStats: newAssetsStats });
    }
    if (this.props.dashboard.assetSelected) {
      const newAssetSelected = this.props.dashboard.assetSelected;
      this.setState({ assetSelected: newAssetSelected });
    }
    this.isMachineNameSelected();
  }




  componentWillReceiveProps(nextProps) {
    if (nextProps.dashboard.assetsStats) {
      this.setState({
        assetsStats: nextProps.dashboard.assetsStats
      });
    }
    if (nextProps.dashboard.assetSelected) {
      this.setState({
        assetSelected: nextProps.dashboard.assetSelected
      });
    }
  }

  isMachineNameSelected = () => {
    const newSettings = this.props.dashboardSettings;
    newSettings.forEach((element) => {
      element.checkboxes.forEach((checkbox) => {
        if (checkbox.label === "machineName" &amp;&amp; checkbox.checked) {
          this.setState({ isMachineNameSelected: true });
          return true;
        }
      });
    });
  }

  /**
   * The render function.
   */
  render() {
    return (
      &lt;div>
        {this.props.dashboard.assetsStats.length > 1 &amp;&amp; this.state.isMachineNameSelected ?
          &lt;div>
            &lt;div>This dashboard was created to show some visualizations and statistics about the tokens you just tagged on the Tagging Tool section. You can tag other words and then come back to this dashboard.
            &lt;/div>
            &lt;div className="dashboard-flexbox">
              &lt;Card className="chart-container">
                &lt;Card.Header as="h5">Number of work orders by assets&lt;/Card.Header>
                &lt;Card.Body>
                  &lt;ResponsiveContainer height={400}>
                    &lt;BarChart
                      data={this.state.assetsStats}
                      margin={{
                        top: 5, right: 30, left: 20, bottom: 5,
                      }}>
                      &lt;CartesianGrid strokeDasharray="3 3" />
                      &lt;XAxis dataKey="asset">
                      &lt;/XAxis>
                      &lt;YAxis>
                      &lt;/YAxis>
                      &lt;Tooltip />
                      &lt;Bar onClick={this.onAssetBarClick} name="Number of related problems by assets" dataKey="problemsRelated"
                        fill="red"
                      />
                    &lt;/BarChart>
                  &lt;/ResponsiveContainer>
                &lt;/Card.Body>
              &lt;/Card>
              &lt;Card className="chart-container">
                &lt;Card.Header as="h5">
                  Most viewed tokens related to asset {this.state.assetSelected.label}
                &lt;/Card.Header>
                &lt;Card.Body>
                  &lt;div>
                    &lt;Tabs variant="tabs" >
                      &lt;Tab eventKey="problems" title="problems">
                        &lt;div>
                          &lt;ResponsiveContainer height={300}>
                            &lt;BarChart data={this.state.assetSelected.mostFoundProblems}>
                              &lt;CartesianGrid strokeDasharray="3 3" />
                              &lt;XAxis dataKey="token">
                              &lt;/XAxis>
                              &lt;YAxis width={70}>
                                &lt;Label angle={-90} value="scores" offset={20} position="insideBottomLeft" />
                              &lt;/YAxis>
                              &lt;Tooltip />
                              &lt;Bar onClick={this.onProblemScoreBarClick} name="scores" dataKey="value"
                                fill="#00A6FF"
                              />
                              &lt;Tooltip />
                            &lt;/BarChart>
                          &lt;/ResponsiveContainer>
                        &lt;/div>
                      &lt;/Tab>
                      &lt;Tab eventKey="items" title="items">
                        &lt;div>
                          &lt;ResponsiveContainer height={300}>
                            &lt;BarChart data={this.state.assetSelected.mostFoundItems}>
                              &lt;CartesianGrid strokeDasharray="3 3" />
                              &lt;XAxis dataKey="token">
                              &lt;/XAxis>
                              &lt;YAxis width={70}>
                                &lt;Label angle={-90} value="scores" offset={20} position="insideBottomLeft" />
                              &lt;/YAxis>
                              &lt;Tooltip />
                              &lt;Bar onClick={this.onItemScoreBarClick} name="scores" dataKey="value"
                                fill="#FFBA5C"
                              />
                              &lt;Tooltip />
                            &lt;/BarChart>
                          &lt;/ResponsiveContainer>
                        &lt;/div>
                      &lt;/Tab>
                      &lt;Tab eventKey="solutions" title="solutions">
                        &lt;div>
                          &lt;ResponsiveContainer height={300}>
                            &lt;BarChart data={this.state.assetSelected.mostFoundSolutions}>
                              &lt;CartesianGrid strokeDasharray="3 3" />
                              &lt;XAxis dataKey="token">
                              &lt;/XAxis>
                              &lt;YAxis width={70}>
                                &lt;Label angle={-90} value="scores" offset={20} position="insideBottomLeft" />
                              &lt;/YAxis>
                              &lt;Tooltip />
                              &lt;Bar onClick={this.onSolutionScoreBarClick} name="scores" dataKey="value"
                                fill="#77D353"
                              />
                              &lt;Tooltip />
                            &lt;/BarChart>
                          &lt;/ResponsiveContainer>
                        &lt;/div>
                      &lt;/Tab>
                    &lt;/Tabs>
                  &lt;/div>
                &lt;/Card.Body>
                &lt;Card.Footer>
                  &lt;small className="text-muted">You can change this chart by clicking on the bars on the left chart&lt;/small>
                &lt;/Card.Footer>
              &lt;/Card>
            &lt;/div>
          &lt;/div>
          :
          &lt;Alert
            variant="danger">
            &lt;Alert.Heading>
              Dashboard not available
            &lt;/Alert.Heading>
            No tokens tagged as a problem, please tag at least one problem from the tokens before you can see the charts or no columns selected as Machine names in previous tab.
          &lt;/Alert>}
      &lt;/div>
    );
  }

  onAssetBarClick = (event) => {
    const headers = [...this.props.headers.headers];
    var selectedHeadersLabels = [];
    var selectedHeaders = headers.filter(header => {
      return header.checked === true;
    });
    selectedHeaders.forEach(header => {
      selectedHeadersLabels.push(header.label);
    });
    this.props.onGetAssetSelected(this.props.dashboard.assetsStats, selectedHeadersLabels, event.asset, event.value);
  }
}

const mapStateToProps = createSelector(
  state => state.dashboard,
  state => state.headers,
  state => state.singleTokens,
  state => state.dashboardSettings,
  (dashboard, headers, singleTokens, dashboardSettings) => ({
    dashboard,
    headers,
    singleTokens,
    dashboardSettings
  })
);
const mapActionsToProps = {
  onGetAssetsStats: getAssetsStats,
  onGetAssetSelected: getAssetSelected,
  onUpdateAlert: updateAlert
};
export default connect(
  mapStateToProps,
  mapActionsToProps
)(Dashboard);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Alert.html">Alert</a></li><li><a href="Button.html">Button</a></li><li><a href="Classification.html">Classification</a></li><li><a href="ClassificationTag.html">ClassificationTag</a></li><li><a href="DashBoard.html">DashBoard</a></li><li><a href="Dashboard_.html">Dashboard</a></li><li><a href="DashboardRedirect.html">DashboardRedirect</a></li><li><a href="DashboardSidebar.html">DashboardSidebar</a></li><li><a href="DragAndDrop.html">DragAndDrop</a></li><li><a href="DynamicSlider.html">DynamicSlider</a></li><li><a href="Error.html">Error</a></li><li><a href="Export.html">Export</a></li><li><a href="Header.html">Header</a></li><li><a href="Headers.html">Headers</a></li><li><a href="HomeComponent.html">HomeComponent</a></li><li><a href="MultiWord.html">MultiWord</a></li><li><a href="NavBar.html">NavBar</a></li><li><a href="OverviewHeader.html">OverviewHeader</a></li><li><a href="Pattern.html">Pattern</a></li><li><a href="Report.html">Report</a></li><li><a href="Router.html">Router</a></li><li><a href="Sidebar.html">Sidebar</a></li><li><a href="Similarity.html">Similarity</a></li><li><a href="SingleRedirect.html">SingleRedirect</a></li><li><a href="SingleWord.html">SingleWord</a></li><li><a href="Slider.html">Slider</a></li><li><a href="TagButton.html">TagButton</a></li><li><a href="TaggingTool.html">TaggingTool</a></li><li><a href="Title.html">Title</a></li><li><a href="TokensNumber.html">TokensNumber</a></li><li><a href="Upload.html">Upload</a></li><li><a href="UploadRedirect.html">UploadRedirect</a></li></ul><h3>Global</h3><ul><li><a href="global.html#routes">routes</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Wed Feb 03 2021 16:06:41 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
